## 아핀 공간
### 이동 변환을 위한 아핀 공간

게임 오브젝트의 **위치/회전/크기 변환**은 아핀 공간에서 구현된다. 유니티의 `Transform` 컴포넌트가 대표적 예시다. 점(P)과 벡터(V)를 구분하는 것이 핵심인데, 캐릭터의 월드 좌표는 **점**, 이동 방향은 **벡터**로 처리한다. 3D 공간에서 오브젝트 이동시 `Translate()` 함수는 내부적으로 아핀 변환 행렬을 적용한다.

### 아핀 공간의 구성 요소

### 점

게임 내 모든 오브젝트의 위치는 점으로 표현된다. 유니티에서 `Vector3` 타입이 (x,y,z) 좌표를 저장하는 방식이 바로 이에 해당한다. **로컬 좌표계**와 **월드 좌표계** 간 변환시 `Transform.TransformPoint()` 메서드를 사용하는 이유도 여기에 있다.

#### 이동 벡터

리지드바디의 `velocity` 속성처럼 방향과 크기를 가진다. 벡터 연산 시 주의할 점은 **좌표계 종속성**이다. 월드 공간 벡터를 로컬 공간으로 변환할 땐 `Transform.InverseTransformDirection()`을 활용해야 한다.

#### 아핀 공간의 성질

**병진변환 보존** 특성은 캐릭터가 맵 전체를 이동해도 상대적 위치 관계가 유지되도록 한다. MMORPG의 대형 레이드에서 모든 플레이어가 동시에 존 이동할 때 이 원리가 적용된다.

### 6.3 아핀 결합

#### 두 점의 결합

NPC의 부드러운 경로 이동을 구현할 때 사용된다. `Vector3.Lerp(a, b, t)` 함수가 두 점 간 선형 보간을 수행하는 대표적 예시다. t값을 조정해 이동 속도를 제어하는 방식은 RPG의 웨이포인트 이동 AI에서 빈번히 활용된다.

### 선 그리기 알고리즘

#### 벡터를 모니터의 점으로 표현

유니티 라인 렌더러 컴포넌트는 이 원리를 기반으로 작동한다. `LineRenderer.SetPositions()` 메서드에 전달하는 좌표 배열이 실제 화면 픽셀 변환 과정을 거친다.

#### 브레젠험 알고리즘

픽셀 아트 게임의 와이어프레임 렌더링에 적용된다. **정수 연산 최적화** 기법은 모바일 게임 개발시 성능 향상의 키포인트가 된다. 최신 GPU는 이 알고리즘을 하드웨어 가속으로 처리한다.

#### 라인 클리핑

카메라 프러스텀 컬링 시스템의 기본 원리다. `GeometryUtility.CalculateFrustumPlanes()`로 얻은 평면 방정식과 선분의 교차 검출이 여기에 해당한다. 오픈월드 게임에서 원거리 오브젝트 렌더링 생략시 이 기술이 필수적이다.


## 내적: 벡터 공간의 분석과 응용

### 벡터의 내적

#### 코사인 법칙 연관성

캐릭터 간 시야각 판별에 직접 적용된다. `Vector3.Dot(a, b)` > 0 이면 전방에 있음을 의미하는 방식이다. FPS 게임에서 적군의 시야 내 진입 판정시 이 계산이 수행된다.

#### 투영 벡터

플랫폼 게임의 경사로 이동시 중력 방향 투영 계산에 사용된다. `Vector3.Project()` 메서드가 이 연산을 구현하며, 캐릭터 컨트롤러의 표면 접촉 판정 알고리즘의 기반이 된다.

### 시야 판별

#### 전후방 판단

RTS 게임의 유닛 자동 회전 기능 구현 핵심이다. 내적 값의 부호를 이용해 목표물이 전방인지 후방인지 즉시 판단할 수 있다. `transform.forward`와 대상 방향 벡터의 내적 계산이 전형적 사례다.

#### 시야 각도 제한

TPS 게임의 카메라 시야 제한 기능에 적용된다. 마우스 델타 값과 내적을 결합해 카메라 회전 각도를 제약하는 방식이다. `Mathf.Clamp()`와 결합해 사용되는 경우가 많다.

### 조명 효과

퐁 조명 모델의 **램버트 반사**가 내적 연산을 기반으로 한다. `ShaderLab`의 `dot(N,L)` 계산이 표면의 법선 벡터(N)와 빛 방향(L)의 각도를 결정한다. 이 값이 0에 가까울수록 어두워지는 효과가 발생한다.

### 충돌 반응

물리 엔진의 탄성 충돌 계산시 내적이 핵심 역할을 한다. `Physics.ComputePenetration()` 메서드 내부에서 충돌 면의 법선 벡터와 속도 벡터의 내적을 이용해 반사 방향을 계산한다. 이때 반사 계수는 내적 값에 비례해 조정된다.


## 정리

### 아핀공간.

개념적 틀

아핀 공간은 **유클리드 공간의 일반화**로, 점과 벡터의 구분에 기반한다. 수학적 정의에 따르면, 아핀 공간은 벡터 공간의 변환(이동)에 대한 자유로운 작용을 허용하는 집합이다. 핵심 요소는 다음과 같다:

- **점**: 위치 정보만 가지며 크기 없음 (예: 게임 오브젝트의 월드 좌표)
    
- **이동 벡터**: 방향과 크기를 가지나 고정된 원점 없음 (예: 유니티 `Translate()` 함수)
    
- **아핀 결합**: 가중치 합계가 1인 점의 선형 결합 (예: `Vector3.Lerp()`를 통한 부드러운 이동)
    

기하적 특성

1. **병진변환 보존**: 오브젝트 그룹의 상대적 위치 관계 유지
    
2. **차원 개념**: 연관 벡터 공간의 차원으로 정의됨
    
3. **평행성**: 평행선은 교차하지 않으나 방향 공유
    

**게임 개발 적용 사례**

- 캐릭터의 월드/로컬 좌표계 변환 (`Transform.TransformPoint()`)
    
- NPC 경로 이동 알고리즘 (웨이포인트 간 아핀 결합)
    
- 대형 맵에서의 오브젝트 배치 최적화


## 내적

### 수학적 정의

두 벡터 간 **각도**와 **투영**을 계산하는 연산으로, 다음 성질을 가진다:

1. 선형성: ⟨_a_+_b_, _c_⟩ = ⟨_a_,_c_⟩ + ⟨_b_,_c_⟩
    
2. 양의 정부호: ⟨_v_,_v_⟩ ≥ 0 (단, _v_=0일 때만 등호)
    
3. 켤레 대칭성: ⟨_a_,_b_⟩ = ⟨_b_,_a_⟩의 복소수 켤레
    

### 게임 물리 엔진 적용

|기능|수학적 구현|게임 사례|
|---|---|---|
|시야 판별|⟨시선 방향, 대상 방향⟩ > 0|FPS 적 탐지|
|조명 효과|램버트 코사인 법칙|퐁 쉐이딩|
|충돌 반응|반사 벡터 계산 = 입사벡터 - 2⟨입사,법선⟩법선|탱크 포탄 반사|

### **최적화 기법**

- SIMD 명령어 활용 (Burst 컴파일러)
    
- 정규화 필수: `Vector3.Normalize()` 미사용 시 각도 계산 오차 발생
    
- 쿼터니언과의 연동: `Quaternion.Dot()`으로 회전 유사도 측정

